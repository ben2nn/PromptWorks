# 前端新建Prompt附件上传功能测试

## 功能概述

已成功为前端新建Prompt功能添加了附件上传支持。现在用户可以：

1. **选择媒体类型**：在新建Prompt时选择文本、图片、文档、音频或视频类型
2. **上传附件**：当选择非文本类型时，可以上传相应格式的文件
3. **预览附件**：支持图片预览、文件信息显示等
4. **管理附件**：可以删除、下载附件

## 主要修改

### 1. 前端界面改进 (PromptManagementView.vue)

- 将新建对话框从简单表单改为使用完整的 `PromptEditor` 组件
- 增加了分类和标签选择的头部区域
- 支持完整的附件上传和管理功能

### 2. 后端API增强 (app/api/v1/endpoints/prompts.py)

- 在创建Prompt时正确处理 `media_type` 字段
- 确保新建和更新Prompt时都能设置媒体类型

### 3. 组件集成

- **PromptEditor**: 完整的Prompt编辑器，支持所有媒体类型
- **FileUploader**: 文件上传组件，支持拖拽上传和进度显示
- **AttachmentPreview**: 附件预览组件，支持多种文件类型
- **MediaTypeSelector**: 媒体类型选择器

## 支持的功能

### 媒体类型支持
- **文本 (TEXT)**: 传统的文本内容编辑
- **图片 (IMAGE)**: JPG、PNG、GIF、WebP 格式
- **文档 (DOCUMENT)**: PDF、Word、文本文档
- **音频 (AUDIO)**: MP3、WAV、OGG 音频文件
- **视频 (VIDEO)**: MP4、AVI、MOV 视频文件

### 附件管理功能
- 文件上传（支持拖拽）
- 上传进度显示
- 文件预览（图片支持缩略图）
- 文件下载
- 文件删除
- 批量操作

### 验证和限制
- 文件大小限制（默认10MB）
- 文件类型验证
- 必填字段验证
- 媒体类型切换时的内容保护

## 使用流程

1. 点击"新建 Prompt"按钮
2. 在头部选择分类和标签
3. 在PromptEditor中填写基本信息
4. 选择合适的媒体类型
5. 根据媒体类型：
   - 文本类型：直接编辑内容
   - 其他类型：上传相应的附件文件
6. 点击"创建提示词"完成创建

## 技术实现

### 前端架构
```
PromptManagementView (主视图)
├── 新建对话框
│   ├── 分类标签选择区域
│   └── PromptEditor 组件
│       ├── MediaTypeSelector
│       ├── FileUploader (非文本类型)
│       └── AttachmentPreview (显示已上传文件)
```

### API集成
- 使用现有的 `attachmentApi` 进行文件上传
- 通过 `promptApi.createPrompt` 创建Prompt
- 支持完整的CRUD操作

## 测试建议

1. **基本功能测试**
   - 创建不同媒体类型的Prompt
   - 上传不同格式的文件
   - 验证文件大小和类型限制

2. **用户体验测试**
   - 拖拽上传功能
   - 上传进度显示
   - 错误处理和提示

3. **边界情况测试**
   - 网络中断时的上传行为
   - 大文件上传
   - 同时上传多个文件

## 注意事项

- 确保后端的附件存储路径配置正确
- 检查文件上传的权限设置
- 监控服务器存储空间使用情况
- 定期清理未关联的附件文件